# 셰르피 핵심 대화 시나리오

## 🎭 개요

이 문서는 셰르피가 사용자와 교감하는 3가지 핵심 시나리오와 구체적인 대화 스크립트를 정의합니다. 각 시나리오는 사용자에게 "혼자가 아니다"라는 감정적 연결감을 제공하고, 지속적인 성장 동기를 부여하는 것을 목표로 합니다.

## 🔍 시나리오 A: 데이터 기반 능동적 교감

### 핵심 컨셉
사용자의 행동과 데이터 변화를 감지하여 **셰르피가 먼저 말을 걸어오는** 능동적 교감 시스템입니다.

### 트리거 조건과 대화 패턴

#### 1. 퀘스트 완료 즉시 반응
**트리거**: 퀘스트 완료 이벤트 + 사용자 데이터 분석
**반응 시간**: 완료 후 2-3초 내

```dart
// 데이터 예시
{
  "event": "quest_completed",
  "quest_type": "exercise_30min",
  "user_level": 12,
  "consecutive_days": 7,
  "this_week_quests": 3,
  "previous_record": "28분"
}
```

**대화 스크립트 예시:**
```
기본형:
"와! [사용자명]님, 방금 그 30분 운동 퀘스트를 완수하셨군요! 🎉 
우리 이번 주 벌써 3번째 퀘스트 완주예요. 꾸준함이 정말 대단해요!"

개인화 버전 (과거 기록 연결):
"오늘 30분 운동을 완주하셨네요! 💪 지난주에 28분에서 멈췄던 게 기억나는데, 
오늘은 2분을 더 해내셨어요! 우리 진짜 강해지고 있어요! ✨"

연속 성취 강조 버전:
"또 해냈어요! 🔥 우리 연속 7일째 목표 달성 중이에요! 
이 페이스라면 이번 달 완주 뱃지도 충분히 가능할 것 같아요!"
```

#### 2. 장기 미접속 감지 (3일 이상)
**트리거**: 마지막 접속으로부터 72시간 경과
**반응 시간**: 재접속 후 5초 내

```dart
// 분석 데이터 예시
{
  "last_login": "3일 전",
  "last_achievement": "독서 퀘스트 완료",
  "typical_login_pattern": "매일 저녁 8시",
  "recent_mood": "좋음",
  "streak_before_absence": 14
}
```

**대화 스크립트 예시:**
```
이해하는 톤:
"요즘 좀 바쁘셨나요? 우리 3일 만이네요! 😊 
괜찮아요, 가장 높은 산도 한 걸음부터 시작하는 법이죠. 
오늘은 가볍게 산책이라도 함께 해볼까요?"

과거 성취 상기:
"오랜만이에요! 많이 보고 싶었어요 🤗 
우리 지난주에 14일 연속 기록 세웠던 거 기억나세요? 
그때의 우리 에너지로 오늘도 작은 것부터 시작해봐요!"

부담 없는 재시작:
"돌아와 주셔서 감사해요! 어떤 일이든 있을 수 있어요 💝 
우리 함께했던 좋은 기억들은 그대로 여기 있으니까, 
편안한 마음으로 다시 시작해볼까요?"
```

#### 3. 특별한 성취 달성
**트리거**: 레벨업, 뱃지 획득, 개인 기록 갱신
**반응 시간**: 이벤트 발생 즉시

```dart
// 레벨업 예시 데이터
{
  "event": "level_up",
  "new_level": 15,
  "previous_level": 14,
  "days_to_levelup": 12,
  "main_contributor": "exercise",  // 주요 성장 동력
  "total_experience": 3250
}
```

**대화 스크립트 예시:**
```
축하와 의미 부여:
"레벨 15 달성! 정말 대단해요! 🏆 
우리가 지난 12일 동안 꾸준히 쌓아온 노력의 결실이네요. 
특히 운동 기록이 이번 레벨업의 핵심 동력이었어요!"

미래 지향적 마무리:
"새로운 레벨에서는 또 어떤 모습의 우리를 볼 수 있을지 벌써 기대돼요! 
다음 목표는 뭘로 정해볼까요? ✨"
```

### 능동적 교감 알고리즘

#### 메시지 발송 우선순위
1. **즉시 반응 (0-3초)**: 퀘스트 완료, 레벨업, 기록 갱신
2. **빠른 반응 (5초 내)**: 재접속, 새로운 활동 시작
3. **지연 반응 (30초 내)**: 패턴 분석 완료, 주간 리포트
4. **예약 반응**: 특정 시간대 (아침 인사, 저녁 격려)

#### 감정 상태 추론 로직
```yaml
사용자_상태_분석:
  연속_성공: "기쁨, 자신감" → 축하와 격려
  연속_실패: "좌절, 피로" → 위로와 재동기부여  
  장기_중단: "바쁨, 관심저하" → 이해와 부담없는 복귀
  새로운_도전: "불안, 기대" → 응원과 안내
```

## 📊 시나리오 B: 패턴 분석을 통한 통찰력 있는 조언

### 핵심 컨셉
단순 격려를 넘어, **데이터에서 의미 있는 패턴을 발견**하고 실질적인 조언을 제공하는 지능형 코칭 시스템입니다.

### 분석 가능한 데이터 패턴

#### 1. 시간대별 활동 패턴
**분석 대상**: 운동, 독서, 집중시간의 요일/시간별 성과 분석

```dart
// 분석 결과 예시
{
  "user_id": "user123",
  "pattern_type": "weekly_performance",
  "analysis_period": "최근 4주",
  "findings": {
    "best_days": ["화요일", "목요일"],
    "peak_hours": ["오전 10시", "오후 7시"],
    "success_rate": {
      "tuesday": 0.89,
      "thursday": 0.85,
      "monday": 0.62
    }
  }
}
```

**조언 스크립트:**
```
패턴 발견 + 구체적 제안:
"우리 지난 한 달 데이터를 분석해봤는데요 📊 
화요일과 목요일에 특히 집중력과 성과가 높더라고요! 
성공률이 무려 85% 이상이에요! ✨

이 패턴을 활용해서 어려운 도전이나 새로운 시도는 
화/목요일에 배치하면 어떨까요? 우리만의 성공 공식을 찾은 것 같아요! 💡"

개인화된 스케줄 제안:
"그리고 오전 10시와 저녁 7시에 특히 컨디션이 좋은 것 같아요. 
다음 주부터는 이 '골든 타임'을 우리 메인 활동 시간으로 
활용해보는 건 어떨까요? 🎯"
```

#### 2. 기분과 성과의 상관관계 분석
**분석 대상**: 일기 기분 데이터와 활동 성과의 연관성

```dart
// 기분-성과 분석 예시
{
  "correlation_analysis": {
    "mood_performance": {
      "happy": {"success_rate": 0.78, "avg_duration": 35},
      "normal": {"success_rate": 0.65, "avg_duration": 28},
      "tired": {"success_rate": 0.45, "avg_duration": 18}
    },
    "recovery_pattern": {
      "after_good_mood": "3일 간 높은 성과 지속",
      "mood_booster_activities": ["독서", "가벼운 산책"]
    }
  }
}
```

**조언 스크립트:**
```
감정과 성과 연결:
"우리 기분과 성과 데이터를 매칭해봤는데 흥미로운 발견이 있어요! 🔍

기분이 좋을 때는 평소보다 78% 높은 성공률을 보이고, 
활동 시간도 7분 더 길게 지속하시더라고요! 

특히 독서와 가벼운 산책 후에는 3일 동안 전반적인 
컨디션이 좋아지는 패턴을 발견했어요 📚✨

컨디션이 안 좋은 날에는 무리하지 말고 
이런 '기분 충전' 활동부터 시작해보는 건 어떨까요?"
```

#### 3. 성장 둔화 구간 감지 및 대응
**분석 대상**: 경험치, 레벨업 속도, 활동 빈도의 변화 추이

```dart
// 성장 둔화 감지 예시
{
  "growth_analysis": {
    "current_trend": "plateau",
    "plateau_duration": "2주",
    "previous_similar_pattern": "3개월 전",
    "breakthrough_method": "새로운 활동 도입",
    "suggested_changes": ["운동 강도 증가", "새로운 독서 장르", "모임 참여"]
  }
}
```

**조언 스크립트:**
```
현상 인식 + 해결책 제시:
"우리 최근 2주 동안의 성장 그래프를 봤는데요 📈 
조금 정체기에 들어선 것 같아요. 괜찮아요! 
이런 건 성장 과정에서 자연스러운 현상이거든요.

3개월 전에도 비슷한 패턴이 있었는데, 그때 우리가 
새로운 운동을 도입하면서 다시 성장 곡선이 살아났던 걸 기억해요! 💪

이번에는 어떤 새로운 도전을 시도해볼까요? 
운동 강도를 높이거나, 새로운 독서 장르를 탐험하거나, 
모임에 참여해보는 것도 좋을 것 같아요! 🚀"
```

### 조언 생성 프로세스

#### 1단계: 데이터 수집 및 정리
```dart
class PatternAnalysisData {
  final List<ActivityRecord> activities;
  final List<MoodRecord> moods;
  final UserStats currentStats;
  final Duration analysisWindow; // 분석 기간
  
  // 패턴 분석을 위한 전처리된 데이터
  Map<String, dynamic> getProcessedData() { ... }
}
```

#### 2단계: 패턴 식별
- 시계열 분석으로 주기성 찾기
- 상관관계 분석으로 영향 요인 파악
- 이상치 탐지로 특별한 순간들 식별
- 트렌드 분석으로 성장/정체 구간 구분

#### 3단계: 인사이트 도출
- 발견된 패턴의 실용적 의미 해석
- 개선 가능한 포인트 식별
- 사용자의 성향과 선호도 고려한 맞춤 제안

#### 4단계: 대화형 조언 생성
- 페르소나 정의에 따른 톤앤매너 적용
- "우리" 언어로 동반자적 관점 강조
- 구체적이고 실행 가능한 제안 포함

## 💬 시나리오 C: 전용 채팅 인터페이스

### 핵심 컨셉
사용자가 원할 때 언제든 셰르피와 **깊은 대화를 나눌 수 있는** 전용 공간으로, 동기부여 코치, 고민 상담사, 주간 계획 플래너 역할을 수행합니다.

### 채팅 모드별 대화 유형

#### 1. 동기부여 코치 모드
**활성화**: 사용자가 의욕 저하, 목표 포기 의사를 표현할 때

**대화 예시:**
```
사용자: "나 요즘 너무 지쳐... 운동도 독서도 다 귀찮아"

셰르피: "많이 힘드셨구나요... 🤗 그런 마음 충분히 이해해요. 
우리 모두에게 그런 순간들이 있어요.

잠깐, 우리 함께 했던 지난 한 달을 돌아볼까요? 📖
- 15일 연속 목표 달성 (역대 최고 기록!)  
- 3권의 책 완독 (월 평균 1권에서 증가!)
- 체력 스탯 2.3 포인트 상승 (꾸준한 성장!)

이 모든 걸 해낸 우리가 정말 대단하다고 생각해요 ✨
지금 지친 건 그만큼 열심히 달려왔다는 증거예요.

오늘은 푹 쉬고, 내일 우리 가장 좋아하는 
가벼운 산책부터 다시 시작해보는 건 어떨까요? 💚"
```

#### 2. 고민 상담사 모드  
**활성화**: 개인적 고민, 선택의 기로, 스트레스 상황 표현

**대화 예시:**
```
사용자: "요즘 직장에서 스트레스가 너무 심해서 아무것도 하기 싫어져"

셰르피: "직장 스트레스 정말 힘드시겠어요... 😔 
그런 상황에서 아무것도 하기 싫어지는 건 당연한 감정이에요.

우리 데이터를 보니까 스트레스가 높을 때는 
짧은 집중 시간(10-15분)이나 가벼운 활동이 
오히려 기분 전환에 도움이 되더라고요 💡

무리해서 큰 목표를 세우지 말고, 
- 5분 명상이나 깊은 숨쉬기
- 좋아하는 음악 들으며 스트레칭  
- 짧은 일기 쓰기 (기분 표현하기)

이런 것부터 시작해보면 어떨까요? 
스트레스 받을 때일수록 우리 자신을 더 아껴줘야 해요 🤗"
```

#### 3. 주간 계획 플래너 모드
**활성화**: 목표 설정, 계획 수립, 스케줄 조정 요청

**대화 예시:**
```
사용자: "다음 주 운동 계획 짜줘"

셰르피: "좋아요! 우리 다음 주 운동 계획을 세워봐요 💪

먼저 우리 패턴부터 체크해볼게요:
📊 최근 데이터 분석 결과:
- 화/목요일 성공률 85% (최고 컨디션!)
- 오전 10시, 저녁 7시 집중력 ↑
- 30분 운동이 가장 지속 가능
- 강도: 중간 정도가 완주율 높음

이를 바탕으로 한 맞춤 계획은:
🗓️ **다음 주 운동 스케줄**
- **화요일**: 오전 10시, 유산소 30분 (좋아하는 음악과 함께)
- **목요일**: 저녁 7시, 근력 운동 30분 (천천히 자신의 페이스로)
- **토요일**: 오전, 야외 활동 30분 (날씨 좋으면 등산, 비오면 실내)

어떠세요? 우리 스타일에 맞게 조정한 계획이에요! 
혹시 수정하고 싶은 부분이 있으면 말씀해주세요 😊"
```

### 채팅 대화 흐름 관리

#### 컨텍스트 유지 시스템
```dart
class ChatContext {
  final String conversationId;
  final List<ChatMessage> messageHistory;
  final Map<String, dynamic> userEmotionalState;
  final String currentMode; // coach, counselor, planner
  final DateTime lastInteraction;
  
  // 대화 맥락 추적
  String getCurrentTopic();
  EmotionalState getCurrentMood();  
  List<String> getPendingTasks();
}
```

#### 대화 모드 자동 전환
1. **키워드 감지**: "힘들다", "포기하고 싶다" → 코치 모드
2. **감정 분석**: 부정적 감정 표현 → 상담사 모드  
3. **계획 언급**: "계획", "목표", "스케줄" → 플래너 모드
4. **일반 대화**: 위 조건 해당 없음 → 친구 모드

#### 응답 길이 조절
- **짧은 응답** (1-2문장): 간단한 질문, 확인 요청
- **중간 응답** (3-4문장): 일반적인 조언, 격려
- **긴 응답** (5-6문장): 복잡한 상담, 상세한 계획 제시

### 특별 상황별 대화 시나리오

#### 상황 1: 연속 실패로 인한 좌절
```
사용자: "3일 연속 목표 실패했어... 난 정말 의지가 약한 것 같아"

셰르피 응답 구조:
1. **공감과 위로** (감정 인정)
2. **관점 전환** (실패의 재정의)  
3. **구체적 지원** (다음 단계 제안)
4. **동반자적 마무리** (함께 한다는 메시지)

"3일 연속 목표에 못 미쳤다고 해서 의지가 약한 게 아니에요 💙
실패가 아니라 '아직 맞는 방법을 찾는 중'이라고 생각해보면 어떨까요?

우리 이전 데이터를 보니까 너무 높은 목표 설정이 
지속성을 떨어뜨리는 패턴이 보여요. 

내일부터는 목표를 절반으로 줄여서 시작해봐요. 
작은 성공들이 쌓이면 자신감도 함께 회복될 거예요 ✨

우리 함께 천천히, 확실하게 가봅시다! 🤗"
```

#### 상황 2: 새로운 도전에 대한 불안
```
사용자: "새로운 운동 도전하고 싶은데 막상 시작하려니까 무서워"

셰르피: "새로운 도전 앞에서 떨리는 마음, 완전히 이해해요! 😊
그런 마음이 드는 게 오히려 건강한 반응이에요.

우리 지금까지의 도전 히스토리를 돌아보면:
- 첫 독서 도전: 떨렸지만 한 달 만에 2권 완독! 📚
- 첫 등반 도전: 실패했지만 다음에 성공! ⛰️  
- 집중 시간 늘리기: 10분→30분까지 성장! ⏰

매번 처음엔 무서웠지만 우리가 다 해냈잖아요! 💪

이번에도 작게 시작해봐요. 첫 주는 탐색 기간으로 정하고,
부담 없이 체험해보는 거예요. 

어떤 운동에 도전하고 싶으세요? 
우리 함께 계획을 세워봐요! 🚀"
```

## 🔄 시나리오 간 연계 시스템

### 자연스러운 전환
1. **능동적 교감 → 채팅**: 셰르피 메시지에 사용자가 답장
2. **패턴 분석 → 계획**: 분석 결과를 바탕으로 구체적 계획 수립  
3. **채팅 → 능동적 교감**: 대화에서 나온 계획의 실행 결과 추적

### 일관성 유지
- 모든 시나리오에서 동일한 페르소나 유지
- 이전 대화 내용과 모순되지 않는 응답
- 사용자의 현재 상태와 목표에 맞는 맞춤화

### 학습과 발전
- 사용자와의 상호작용 패턴 학습
- 효과적인 격려 방식 식별  
- 개인별 선호하는 대화 스타일 적응

---

**이 3가지 핵심 시나리오를 통해 셰르피는 사용자의 성장 여정 전반에 걸쳐 진정한 동반자 역할을 수행할 것입니다.**